<div class="basic-info-container">
  <div class="section-header">
    <i class="bi bi-person-circle"></i>
    <h2>Informações Básicas do Personagem</h2>
    <p class="section-description">Preencha os dados fundamentais do seu aventureiro</p>
  </div>

  <form class="info-form">
    <!-- Fileira 1: Nome do Personagem (maior) e Nível Total (menor, readonly) -->
    <div class="form-row row-1">
      <div class="form-group col-name">
        <label for="nomePersonagem" class="form-label"> Nome do Personagem </label>
        <div class="input-wrapper">
          <i class="bi bi-person-badge input-icon"></i>
          <input
            type="text"
            id="nomePersonagem"
            class="form-control featured-input with-icon"
            [(ngModel)]="basicInfo.nomeDoPersonagem"
            name="nomePersonagem"
            placeholder="Digite o nome do seu personagem"
            [disabled]="!isEditMode"
          />
        </div>
      </div>

      <div class="form-group col-nivel">
        <label for="nivel" class="form-label"> Nível Total </label>
        <div class="input-wrapper">
          <i class="bi bi-arrow-up-circle input-icon"></i>
          <input
            type="number"
            id="nivel"
            class="form-control text-center with-icon"
            [value]="basicInfo.nivel"
            name="nivel"
            min="1"
            max="20"
            placeholder="1"
            readonly
            title="Nível calculado automaticamente"
          />
        </div>
      </div>
    </div>

    <!-- Fileira 2: Classes e Níveis (Multiclasse) -->
    <div class="form-row row-2">
      <div class="multiclass-header">
        <button
          type="button"
          class="btn-toggle-multiclass"
          (click)="toggleMulticlasse()"
          [disabled]="!isEditMode"
        >
          <i class="bi" [ngClass]="mostrarMulticlasse ? 'bi-chevron-down' : 'bi-chevron-right'"></i>
          <span>{{ mostrarMulticlasse ? 'Classes' : 'Classe e Subclasse' }}</span>
          <small class="badge-classes"
            >{{ basicInfo.classes.length }}
            {{ basicInfo.classes.length === 1 ? 'classe' : 'classes' }}</small
          >
        </button>
      </div>

      <!-- Modo simplificado: mostra apenas primeira classe -->
      <div class="classes-simple" *ngIf="!mostrarMulticlasse">
        <div class="form-group">
          <label for="classe-0" class="form-label"> Classe </label>
          <div class="input-wrapper">
            <i class="bi bi-shield-fill input-icon"></i>
            <input
              type="text"
              id="classe-0"
              class="form-control with-icon"
              [(ngModel)]="basicInfo.classes[0].classe"
              name="classe-0"
              placeholder="Ex: Guerreiro, Mago"
              [disabled]="!isEditMode"
              (ngModelChange)="calcularNivelTotal()"
            />
          </div>
        </div>

        <div class="form-group">
          <label for="subclasse-0" class="form-label"> Subclasse </label>
          <div class="input-wrapper">
            <i class="bi bi-star-fill input-icon"></i>
            <input
              type="text"
              id="subclasse-0"
              class="form-control with-icon"
              [(ngModel)]="basicInfo.classes[0].subclasse"
              name="subclasse-0"
              placeholder="Ex: Campeão, Evocador"
              [disabled]="!isEditMode"
              (ngModelChange)="calcularNivelTotal()"
            />
          </div>
        </div>

        <div class="form-group">
          <label for="nivel-0" class="form-label"> Nível </label>
          <div class="input-wrapper">
            <i class="bi bi-arrow-up-circle input-icon"></i>
            <input
              type="number"
              id="nivel-0"
              class="form-control text-center with-icon"
              [(ngModel)]="basicInfo.classes[0].nivel"
              name="nivel-0"
              min="1"
              max="20"
              placeholder="1"
              [disabled]="!isEditMode"
              (ngModelChange)="calcularNivelTotal()"
            />
          </div>
        </div>
      </div>

      <!-- Modo multiclasse: mostra todas as classes -->
      <div class="classes-multiclass" *ngIf="mostrarMulticlasse">
        <div class="multiclass-list">
          <div class="multiclass-item" *ngFor="let classeItem of basicInfo.classes; let i = index">
            <div class="multiclass-item-header">
              <span class="multiclass-number">Classe {{ i + 1 }}</span>
              <button
                type="button"
                class="btn-remove-class"
                (click)="removerClasse(i)"
                [disabled]="!isEditMode || basicInfo.classes.length === 1"
                title="Remover classe"
              >
                <i class="bi bi-x-circle"></i>
              </button>
            </div>

            <div class="multiclass-fields">
              <div class="form-group multiclass-col-classe">
                <label [for]="'classe-' + i" class="form-label"> Classe </label>
                <div class="input-wrapper">
                  <i class="bi bi-shield-fill input-icon"></i>
                  <input
                    type="text"
                    [id]="'classe-' + i"
                    class="form-control with-icon"
                    [(ngModel)]="classeItem.classe"
                    [name]="'classe-' + i"
                    placeholder="Ex: Guerreiro"
                    [disabled]="!isEditMode"
                    (ngModelChange)="calcularNivelTotal()"
                  />
                </div>
              </div>

              <div class="form-group multiclass-col-subclasse">
                <label [for]="'subclasse-' + i" class="form-label"> Subclasse </label>
                <div class="input-wrapper">
                  <i class="bi bi-star-fill input-icon"></i>
                  <input
                    type="text"
                    [id]="'subclasse-' + i"
                    class="form-control with-icon"
                    [(ngModel)]="classeItem.subclasse"
                    [name]="'subclasse-' + i"
                    placeholder="Ex: Campeão"
                    [disabled]="!isEditMode"
                    (ngModelChange)="calcularNivelTotal()"
                  />
                </div>
              </div>

              <div class="form-group multiclass-col-nivel">
                <label [for]="'nivel-' + i" class="form-label"> Nível </label>
                <div class="input-wrapper">
                  <i class="bi bi-arrow-up-circle input-icon"></i>
                  <input
                    type="number"
                    [id]="'nivel-' + i"
                    class="form-control text-center with-icon"
                    [(ngModel)]="classeItem.nivel"
                    [name]="'nivel-' + i"
                    min="1"
                    max="20"
                    placeholder="1"
                    [disabled]="!isEditMode"
                    (ngModelChange)="calcularNivelTotal()"
                  />
                </div>
              </div>
            </div>
          </div>
        </div>

        <button
          type="button"
          class="btn-add-class"
          (click)="adicionarClasse()"
          [disabled]="!isEditMode || basicInfo.classes.length >= 4"
          title="Adicionar classe"
        >
          <i class="bi bi-plus-circle"></i>
          <span>Adicionar Classe</span>
        </button>
      </div>

      <!-- Antecedente (sempre visível) -->
      <div class="form-group form-group-antecedente">
        <label for="antecedente" class="form-label"> Antecedente </label>
        <div class="input-wrapper">
          <i class="bi bi-book input-icon"></i>
          <input
            type="text"
            id="antecedente"
            class="form-control with-icon"
            [(ngModel)]="basicInfo.antecedente"
            name="antecedente"
            placeholder="Ex: Soldado, Sábio"
            [disabled]="!isEditMode"
          />
        </div>
      </div>
    </div>

    <!-- Fileira 3: Espécie, Alinhamento, Tamanho -->
    <div class="form-row row-3">
      <div class="form-group">
        <label for="especie" class="form-label"> Espécie </label>
        <div class="input-wrapper">
          <i class="bi bi-gem input-icon"></i>
          <input
            type="text"
            id="especie"
            class="form-control with-icon"
            [(ngModel)]="basicInfo.especie"
            name="especie"
            placeholder="Ex: Humano, Elfo, Anão"
            [disabled]="!isEditMode"
          />
        </div>
      </div>

      <div class="form-group">
        <label for="alinhamento" class="form-label"> Alinhamento </label>
        <div class="input-wrapper">
          <i class="bi bi-compass input-icon"></i>
          <select
            id="alinhamento"
            class="form-control with-icon"
            [(ngModel)]="basicInfo.alinhamento"
            name="alinhamento"
            [disabled]="!isEditMode"
          >
            <option value="">Selecione o alinhamento</option>
            <option value="LB">Leal e Bom</option>
            <option value="NB">Neutro e Bom</option>
            <option value="CB">Caótico e Bom</option>
            <option value="LN">Leal e Neutro</option>
            <option value="N">Neutro</option>
            <option value="CN">Caótico e Neutro</option>
            <option value="LM">Leal e Mau</option>
            <option value="NM">Neutro e Mau</option>
            <option value="CM">Caótico e Mau</option>
          </select>
        </div>
      </div>

      <div class="form-group">
        <label for="tamanho" class="form-label"> Tamanho </label>
        <div class="input-wrapper">
          <i class="bi bi-arrows-fullscreen input-icon"></i>
          <select
            id="tamanho"
            class="form-control with-icon"
            [(ngModel)]="basicInfo.tamanho"
            name="tamanho"
            [disabled]="!isEditMode"
          >
            <option value="">Selecione</option>
            <option value="Minúsculo">Minúsculo</option>
            <option value="Pequeno">Pequeno</option>
            <option value="Médio">Médio</option>
            <option value="Grande">Grande</option>
            <option value="Enorme">Enorme</option>
            <option value="Imenso">Imenso</option>
          </select>
        </div>
      </div>
    </div>

    <!-- Botões de Ação: Salvar, Editar, Limpar -->
    <div class="form-actions">
      <button type="button" class="btn btn-save" (click)="saveInfo()" [disabled]="!isEditMode">
        <i class="bi bi-save"></i>
        <span>Salvar</span>
      </button>
      <button type="button" class="btn btn-edit" (click)="editInfo()" [disabled]="isEditMode">
        <i class="bi bi-pencil"></i>
        <span>Editar</span>
      </button>
      <button type="button" class="btn btn-reset" (click)="resetInfo()">
        <i class="bi bi-arrow-counterclockwise"></i>
        <span>Limpar</span>
      </button>
    </div>
  </form>
</div>
